function cov = getMinCoverage(walker, SMA, INC, disc)

mu = astroConstants(14);
R = 3389.5;


TT = walker(1);
P = walker(2);
F = walker(3);

n = 2000;
n_sat = TT/P;
n_orbits = P;

n_lon = 8;
n_lat = 8;

alt = 0;

LON = linspace(-170, 170, n_lon);
LAT = linspace(-80, 80, n_lat);


T_orb = 2 * pi * sqrt(SMA^3 / mu);
tspan = linspace(0, 3*T_orb, n);

X0 = [SMA, 1e-8, INC, 0, 0, 0];

gamma = deg2rad(20);

opt = odeset('AbsTol', 1e-6, 'RelTol', 1e-6);

N = zeros(n,n_sat * n_orbits + 3);
N_mesh = zeros(n_lat, n_lon);
N_mesh_mean = zeros(n_lat, n_lon);

tic
for lo = 1 : n_lon
    for la = 1 : n_lat
        
        for ii = 1 : n_orbits
            for kk = 1 : n_sat
                X0(6) = (kk - 1) * pi /2 + (ii - 1) * F * 2 * pi / TT;
                X0(4) = (ii - 1) * 2 * pi / P;
                [T,Y] = trajectory(X0, tspan, mu, opt);
                theta = footPrintRadius(gamma, Y, alt);
                for jj = 1 : n
                    N(jj, (ii-1)*n_sat + kk) = coverageNumber(LAT(la), LON(lo), T(jj), Y(jj,:), theta(jj));
                end
            end
        end
        
        NN = sum(N,2);
        N_min = min(NN);
        N_mesh(la, lo) = N_min;
        N_mean = mean(NN);
        N_mesh_mean(la, lo) = N_mean;
    end
end
toc

end
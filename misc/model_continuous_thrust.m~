function [T_tot,states_tot, parout_tot, events] = model_continuous_thrust(X0, parameters)
       
        states = X0;
        i_e = 0;
        T_tot = []; states_tot = []; parout_tot = []; events = [];
        T = parameters.t0sym*86400;
        while T(end) <  parameters.tmax*86400 || i_e == 1
            %initialization of each step

            X0 = states(end,:);
            
            if i_e == 3 %t_BO is over
                parameters.T = [0; 0; 0];
                parameters.t_BO = parameters.tmax*86400 - T(end) + 1;
            end
            
            [T, states, parout, i_e] = gauss_cont_thrust_model(X0, parameters);
            
            parameters.t_BO = parameters.t_BO - (T(end) - parameters.t0sym);
            parameters.M0 = parameters.M0 - states(end,7); 
            
            T_tot = [T_tot; T];
            states_tot = [states_tot; states];
            parout_tot = [parout_tot; parout];
            events = [T(end) i_e];
        end


end

